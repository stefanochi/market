<!DOCTYPE html>
<html>
    <head>

        <meta name="viewport" content="width=device-width, initial-scale=1">

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.12/handlebars.min.js"></script>

        <script src="app/js/loginSignup.js"></script>
        <script src="app/js/profile.js"></script>
        <script src="app/js/products.js"></script>
        <script src="app/js/router.js"></script>
        <script src="app/js/navbar.js"></script>
        <script src="app/js/cart.js"></script>
        <script src="app/js/reviews.js"></script>
        <script src="app/js/main.js"></script>

        <link rel="stylesheet" href="app/css/style.css">

        <title>Exchange</title>
    </head>
    <body>
        <div class="navbar">
            <div class="navbar_content"><!--
            --><div class="nav-left"></div><!--
            --><div class="nav-center"><!--
                --><div class="nav_search">
                        <input id="search_input" placeholder="Search">
                        <button id="search_submit" class="navbar_button primary_button">Search</button>
                    </div><!--
            --></div><!--
            --><div class="nav-right">
                    <span class="close">&times;</span>
                    <div class="nav_links">
                        <a href="#profile/">Profile</a>
                        <a href="#login" id="logout_button">Login</a>
                    </div>
                </div>
                <div class="menu-icon">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
        </div>
        <div class="alert_div hidden">
            <span id="alert_text">This is a message</span>
        </div>
        <!-- this div contains the modal windows -->
        <div>
                <!-- window to add a new product -->
                <div id="addProduct_modal" class="hidden modal">
                    <div class="addProduct_div modal-content">
                        <div class="modal-header">
                            <span class="close">&times;</span>
                            <h1>Add new product</h1>
                        </div>
                        <div class="modal-body">
                            <input type="text" id="product_title" placeholder="Title">
                            <input type="number" id="product_price" placeholder="Price">
                            <input type="url" id="product_image" placeholder="Image Url">
                            <textarea id="product_description" placeholder="Description"></textarea>
                            <div class="modal-buttons">
                                <button class="confirm primary_button float_right">Add Product</button>
                                <button class="cancel secondary_button float_right">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- cart checkout confirmation -->
                <div id="confirmCheckout_modal" class="modal hidden">
                    <div class="modal-content">
                        <div class="modal-header">
                            <span class="close">&times;</span>
                            <h1>Confirmation</h1>
                        </div>
                        <div class="modal-body">
                            <p>Are you sure?</p>
                            <div class="modal-buttons">
                                <button class="confirm primary_button float_right">Checkout</button>
                                <button class="cancel secondary_button float_right">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- edit profile window -->
                <div id="editProfile_modal" class="modal hidden">
                    <div class="editProfile_div modal-content">
                        <div class="modal-header">
                            <span class="close">&times;</span>
                            <h1>Edit Profile</h1>
                        </div>
                        <div id="editProfile_form" class="modal-body">
                            <input id="editProfile_username" type="text" placeholder="Username">
                            <input id="editProfile_email" type="email" placeholder="Email">
                            <input id="editProfile_image" type="url" placeholder="Profile Picture url">
                            <textarea id="editProfile_info" placeholder="Description"></textarea>
                            <div class="modal-buttons">
                                <button id="editProfile_save" class=" confirm primary_button float_right">Save</button>
                                <button class="cancel secondary_button float_right">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- window to update a product -->
                <div id="updateProduct_modal" class="hidden modal">
                    <div class="updateProduct_div modal-content">
                            <div class="modal-header">
                            <span class="close">&times;</span>
                            <h1>Update Product</h1>
                        </div>
                        <div class="modal-body">
                            <input type="text" id="updateProduct_id" class="hidden">
                            <input type="text" id="updateProduct_title" placeholder="Title">
                            <input type="number" id="updateProduct_price" placeholder="Price">
                            <input type="url" id="updateProduct_image" placeholder="Image Url">
                            <textarea id="updateProduct_description" placeholder="Description"></textarea>
                            <label for="sold">
                                <input type="radio" id="sold" class="updateProduct_sold" name="sold" value="sold"/>
                                Sold
                            </label>
                            <label for="available">
                                <input type="radio" id="available" class="updateProduct_sold" name="sold" value="available/">
                                Available
                            </label>
                            <div class="modal-buttons">
                                <button class="confirm primary_button float_right">Update Product</button>
                                <button class="cancel secondary_button float_right">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- window to confirm deletion -->
                <div id="confirmDelete_modal" class="modal hidden">
                    <div class="modal-content">
                        <div class="modal-header">
                            <span class="close">&times;</span>
                            <h1>Confirmation</h1>
                        </div>
                        <div class="modal-body">
                            <p>Are you sure you want to delete the product?</p>
                            <div class="modal-buttons">
                                <button class="confirm primary_button float_right">Delete</button>
                                <button class="cancel secondary_button float_right">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- window to add review -->
                <div id="addReview_modal" class="hidden modal">
                    <div class="addReview_div modal-content">
                        <div class="modal-header">
                            <span class="close">&times;</span>
                            <h1>Add new review</h1>
                        </div>
                        <!-- form to add review -->
                        <form id="addReview_form" class="modal-body">
                            <input id="addReview_rating" type="number" placeholder="rating">
                            <textarea id="addReview_text" placeholder="text"></textarea>
                            <div class="modal-buttons">
                                <input id="addReview_submit" class="primary_button float_right" type="submit" value="Send">
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        <div class="content">
            <!--this div contains the content of the page-->
            <div class="column cl-1"><div class="left">
                <!-- first column, contains only the advanced search div -->
                    <div id="advancedSearch_div" class="section_main hidden">
                        <div class="header_div">
                            <h1>Refine Search</h1>
                        </div>
                        <form id="advancedSearch_form" class="advancedSearch_div">
                            <input id="advancedSearch_minPrice" type="number" placeholder="minimum price">
                            <input id="advancedSearch_maxPrice" type="number" placeholder="maximum price">
                            <select id="advancedSearch_order">
                                <option value="descending">Descending</option>
                                <option value="ascending"  selected="selected">Ascending</option>
                            </select>
                            <input class="primary_button" type="submit" value="Search">
                        </form>
                    </div>
                </div>
            </div>
            <!-- central column, initially empty -->
            <div class="column cl-2"><div class="main"></div></div>
            <!-- right column, contains the cart -->
            <div class="column cl-3"><div class="right">
                <div id="cart_div" class="section_main hidden">
                    
                    <div class="header_div">
                        <h1>Cart</h1>
                        <button id="cart_buy" class="primary_button">Checkout</button>
                    </div>
                    <div id="cartList_div">
                        <!-- contains the products in the cart -->
                    </div>
                </div>
            </div>
        </div>
        </div>
        <div class="templates">
            <!-- contains the templates to be compiled with handlebars -->
            
            <!-- template for the profile page -->
            <script id="profile_template" type="text/x-handlebars-template">
                <div id="info_div" class="section_main">
                    <div class="header_div">
                        <h1>{{username}}</h1>
                    </div>
                    <div class="info_content">
                        <!-- when clicked it shows a windows to edit the profile -->
                        <span id="editProfile_button" class="hidden">Edit</span>
                        <div class="column-left">
                            {{#if image}}
                            <img src="{{image}}" alt="profile image"> 
                            {{/if}}
                        </div>
                        <h2>Email: {{email}}</h2>
                        <p>{{info}}</p>
                    </div>
                </div>
                <div id="products_div" class="section_main">
                    <div class="header_div">
                        <h1>Products sold by the user</h1>
                        <!-- button to show the form to add a new product -->
                        <button id='addProduct_button' class='primary_button hidden float_right'>Add Product</button> 
                    </div>   
                    <div id="productList_div" class="section_content">
                        <!-- list of selling products -->
                        <!-- the products will be added dynamically -->
                    </div>
                </div>
                <div id="reviews_div" class="section_main">
                    <div class="header_div">
                        <h1>Reviews of the user</h1>
                        <!-- button to show the form to add a new product -->
                        <button id='addReview_button' class='primary_button hidden float_right'>Leave Review</button>
                    </div>
                    <div id="reviewList_div" class="section_content">
                        <!-- listo of reviews -->
                        <!-- the reviews will be added dynamically -->
                    </div>
                </div> 
            </script>

            <script id="searchResult_template" type="text/x-handlebars-template">
                <div id="products_div" class="section_main">
                    <div class="header_div">
                        <h1>Products found</h1>
                    </div>
                    <div id="productList_div" class="section_content">
                        <!-- list of selling products -->
                    </div>
                </div>
            </script>
            
            <!-- template fotr the login page -->
            <script id="login_template" type="text/x-handlebars-template">
                <div class="login_div  section_main">
                    <div class="header_div">
                        <h1>Login</h1>
                    </div>
                    <div class="form_div">
                        <input type="text" id="username_login" placeholder="Username">
                        <input type="password" id="password_login" placeholder="Password">
                        <button id="submit_login" class="primary_button">Login</button>
                        <h2>or</h2>
                        <button id="signup_link" class="primary_button">Sign Up</button>
                    </div>
                </div>
            </script>
            
            <!-- signup page -->
            <script id="signup_template" type="text/x-handlebars-template">
                <div class="login_div  section_main">
                    <div class="header_div">
                        <h1>Signup</h1>
                    </div>
                    <div class="form_div">
                        <input type="text" id="username_signup" placeholder="Username">
                        <input type="email" id="email_signup" placeholder="Email">
                        <input type="password" id="password_signup" placeholder="Password">
                        <button id="submit_signup" class="primary_button">Sing Up</button>
                    </div>
                </div>
            </script>
            
            <!-- template for a single product -->
            <script id="product_template" type="text/x-handlebars-template">
                <div class="product_div" id={{ID}}>
                    <div class="product_header">
                        <div class="title_div">
                            <h1 class="product_title">{{title}}</h1>
                            <h2>&nbspby <a href="#profile/{{ownerID}}" class="product_owner">{{ownerName}}</a></h2>
                            <span class="product_sold">
                                {{#if sold}}
                                    Sold 
                                {{/if}}
                            </span>
                        </div>
                        <div class="price_div float_right">
                            <h1 class="product_price">{{price}}$</h1>
                        </div>
                    </div>
                    <!-- display the image only if defined -->
                    {{#if image}}
                        <img src="{{image}}" alt="product image"> 
                    {{/if}}
                    <p class="product_description">{{description}}</p>
                    <div class="button_div float_right">
                            <button class='product_delete secondary_button hidden'>Delete</button>
                            <button class='product_update primary_button hidden'>Update</button>
                            <button class='product_addToCart primary_button hidden'>Add To Cart</button>
                    </div>
                </div>
            </script>

            <!-- template for a single product in the cart -->
            <script id="cartProduct_template" type="text/x-handlebars-template">
                <div id=cartProduct_{{ID}} class="cartProduct_div">
                    <div>
                        <h2 class="cartProduct_title">{{title}}</h2>
                        by <a href="#profile/{{ownerID}}">{{ownerName}}</a>
                    </div>     
                    <h2 class="cartProduct_price">{{price}}</h2>
                    <button class="cartProduct_remove secondary_button float_right">Remove</button> 
                </div>
            </script>

            <!-- template for a single review -->
            <script id="review_template" type="text/x-handlebars-template">
                <div id="review_{{writerID}}" class="review_div">
                    <div class="column-left">
                        <!-- display the image only if defined -->
                        {{#if writer_image}}
                            <img src="{{writer_image}}" alt="writer image"> 
                        {{/if}}
                    </div>
                    <div class="review_content">
                        <a href="#profile/{{writerID}}"><h2>{{writerUsername}}:</h2></a>
                        <h2>Rating: {{rating}}</h2>
                        <p>Text: {{text}}</p>
                        <p class="review_date">{{pub_date}}</p>
                        <button class="secondary_button remove_review hidden">Remove</button>
                    </div>
                </div>
            </script>

        </div>
    </body>
</html>